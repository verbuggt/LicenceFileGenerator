package net.exploit.licencegen.main;

import java.security.SecureRandom;
import java.util.ArrayList;

public class KeyGenerator {

	char[] chars = "abcdefghijklmnopqrstuvwxyz1234567890".toCharArray();
	ArrayList<Character> use = new ArrayList<Character>();

	public static void main(String[] args) {
		KeyGenerator keyGenerator = new KeyGenerator();
		System.out.println(keyGenerator.getRandomKey(16));
	}

	public KeyGenerator() {
		use = getCharacterListFromCharArray(chars);
	}

	public String getRandomKey(int length) {
		ArrayList<Character> use = new ArrayList<>(this.use);
		SecureRandom r = new SecureRandom();

		String key = "";
		for (int i = 0; i < length; i++) {
			if (use.size() == 32)
				use = new ArrayList<>(this.use);
			char c = use.get(r.nextInt(use.size()));
			key += c;
			use.remove(Character.valueOf(c));
		}
		return key;
	}

	private ArrayList<Character> getCharacterListFromCharArray(char[] chararray) {
		ArrayList<Character> l = new ArrayList<>();
		for (char c : chararray) {
			l.add(c);
		}
		return l;
	}

}
